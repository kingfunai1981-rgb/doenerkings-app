<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üîê Admin - D√∂ner Boxx</title>
<link rel="icon" href="/favicon-new.png" type="image/png">
<link rel="apple-touch-icon" href="/apple-touch-icon-new.png">
<style>
@font-face { font-family: 'Flame'; src: url('Flame-Regular.ttf') format('truetype'); font-weight: normal; font-style: normal; }
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Flame', system-ui, -apple-system, sans-serif; background: linear-gradient(135deg, #E31E24 0%, #F9A825 100%); min-height: 100vh; padding: 20px; }

/* Login Styles */
.login-container {
  max-width: 400px;
  margin: 100px auto;
  background: white;
  border-radius: 20px;
  padding: 40px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
  text-align: center;
}
.login-logo {
  width: 100px;
  height: 100px;
  margin: 0 auto 30px;
}
.login-logo img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}
.login-title {
  color: #E31E24;
  font-size: 32px;
  font-weight: 700;
  margin-bottom: 10px;
}
.login-subtitle {
  color: #6b7280;
  font-size: 16px;
  margin-bottom: 30px;
}
.password-container {
  position: relative;
  margin-bottom: 20px;
}
.password-container input {
  width: 100%;
  padding: 16px 50px 16px 16px;
  border: 2px solid #e5e7eb;
  border-radius: 12px;
  font-size: 18px;
  font-weight: 600;
  letter-spacing: 4px;
  transition: all 0.3s;
}
.password-container input:focus {
  outline: none;
  border-color: #E31E24;
  box-shadow: 0 0 0 4px rgba(227, 30, 36, 0.1);
}
.toggle-password {
  position: absolute;
  right: 16px;
  top: 50%;
  transform: translateY(-50%);
  cursor: pointer;
  font-size: 20px;
  color: #6b7280;
  transition: all 0.2s;
}
.toggle-password:hover {
  color: #E31E24;
}
.login-btn {
  width: 100%;
  padding: 16px;
  background: linear-gradient(135deg, #E31E24, #F9A825);
  color: white;
  border: none;
  border-radius: 12px;
  font-size: 18px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s;
}
.login-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(227, 30, 36, 0.3);
}
.login-error {
  background: #fee2e2;
  color: #991b1b;
  padding: 12px;
  border-radius: 8px;
  margin-top: 16px;
  font-size: 14px;
  font-weight: 600;
  display: none;
}

/* Admin App Styles */
#app { display: none; }
.container { max-width: 1400px; margin: 0 auto; }
.card { background: white; border-radius: 20px; padding: 24px; margin-bottom: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
.header-card { display: flex; align-items: center; gap: 20px; }
.header-logo { width: 80px; height: 80px; flex-shrink: 0; }
.header-logo img { width: 100%; height: 100%; object-fit: contain; }
.header-text { flex: 1; }
.logout-btn {
  padding: 10px 20px;
  background: #dc2626;
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
}
.logout-btn:hover { background: #b91c1c; }
h1 { color: #E31E24; font-size: 28px; margin-bottom: 8px; }
h2 { color: #374151; font-size: 20px; margin-bottom: 16px; }
h3 { color: #374151; font-size: 18px; margin-bottom: 12px; }
.subtitle { color: #6b7280; font-size: 14px; margin-bottom: 20px; }

button { padding: 12px 20px; border: none; border-radius: 10px; font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
button.primary { background: linear-gradient(135deg, #E31E24, #F9A825); color: white; width: 100%; margin-bottom: 10px; }
button.primary:hover { opacity: 0.9; transform: translateY(-1px); }
button.danger { background: #dc2626; color: white; padding: 8px 16px; font-size: 14px; }
button.danger:hover { background: #b91c1c; }
button.success { background: #F9A825; color: white; width: 100%; }
button.success:hover { background: #f59e0b; }
button.secondary { background: #6b7280; color: white; }
button.secondary:hover { background: #4b5563; }

input, select, textarea { width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 15px; margin-bottom: 10px; transition: all 0.2s; }
input:focus, select:focus, textarea:focus { outline: none; border-color: #E31E24; }
.form-label { display: block; font-weight: 600; color: #374151; margin-bottom: 6px; font-size: 14px; }

.result { padding: 12px; border-radius: 8px; margin-top: 12px; font-size: 14px; text-align: center; font-weight: 600; }
.result.success { background: #fef3c7; color: #92400e; border: 2px solid #F9A825; }
.result.error { background: #fee2e2; color: #991b1b; border: 2px solid #ef4444; }
.result.info { background: #dbeafe; color: #1e40af; border: 2px solid #3b82f6; }

.password-card {
  background: linear-gradient(135deg, #8b5cf6, #a78bfa);
  border: 3px solid #7c3aed;
  border-radius: 20px;
  padding: 30px;
  color: white;
  margin-bottom: 20px;
}

.password-display {
  background: white;
  border-radius: 12px;
  padding: 24px;
  margin: 20px 0;
  text-align: center;
}

.current-password {
  font-size: 48px;
  font-weight: 900;
  letter-spacing: 8px;
  color: #E31E24;
  font-family: monospace;
  margin: 20px 0;
  user-select: all;
}

.copy-btn {
  background: linear-gradient(135deg, #10b981, #34d399);
  color: white;
  padding: 16px 32px;
  border: none;
  border-radius: 12px;
  font-size: 18px;
  font-weight: 700;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 10px;
  transition: all 0.3s;
}

.copy-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 16px rgba(16, 185, 129, 0.3);
}

.password-info {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-top: 20px;
}

.info-item {
  background: rgba(255, 255, 255, 0.2);
  padding: 16px;
  border-radius: 10px;
  text-align: center;
}

.info-value {
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 4px;
}

.info-label {
  font-size: 13px;
  opacity: 0.9;
}

.generate-btn {
  background: white;
  color: #8b5cf6;
  padding: 14px 28px;
  border: none;
  border-radius: 10px;
  font-size: 16px;
  font-weight: 700;
  cursor: pointer;
  margin-top: 16px;
}

.generate-btn:hover {
  background: #f3f4f6;
}

.history-list {
  max-height: 300px;
  overflow-y: auto;
  margin-top: 16px;
}

.history-item {
  background: white;
  padding: 12px;
  border-radius: 8px;
  margin-bottom: 8px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border: 2px solid #e5e7eb;
}

.history-date {
  font-weight: 600;
  color: #111827;
}

.history-password {
  font-family: monospace;
  font-weight: 700;
  color: #6b7280;
  letter-spacing: 2px;
}

.security-badge {
  background: #dcfce7;
  border: 2px solid #22c55e;
  color: #166534;
  padding: 16px;
  border-radius: 10px;
  margin-top: 20px;
  font-size: 14px;
  font-weight: 600;
}
</style>
</head>
<body>

<!-- Login Screen -->
<div id="loginScreen" class="login-container">
  <div class="login-logo">
    <img src="/logo-round-new.png" alt="D√∂ner Boxx">
  </div>
  <div class="login-title">Admin Login</div>
  <div class="login-subtitle">Hauptpasswort eingeben</div>
  
  <div class="password-container">
    <input type="password" id="adminPassword" placeholder="Passwort eingeben" autocomplete="off">
    <span class="toggle-password" onclick="togglePasswordVisibility()">üëÅÔ∏è</span>
  </div>
  
  <button class="login-btn" onclick="handleLogin()">üîì Anmelden</button>
  
  <div class="login-error" id="loginError">‚ùå Falsches Passwort!</div>
</div>

<!-- Admin App -->
<div id="app">
<div class="container">
  <div class="card header-card">
    <div class="header-logo"><img src="/logo-round-new.png" alt="D√∂ner Boxx"></div>
    <div class="header-text">
      <h1>üîê Admin Bereich</h1>
      <p class="subtitle">Scanner-Passw√∂rter verwalten & System kontrollieren</p>
    </div>
    <button class="logout-btn" onclick="handleLogout()">üö™ Ausloggen</button>
  </div>

  <!-- üîê T√ÑGLICHES PASSWORT MANAGEMENT -->
  <div class="password-card">
    <h2 style="color: white; font-size: 32px; margin-bottom: 12px;">üîê Scanner Tages-Passwort</h2>
    <p style="opacity: 0.9; font-size: 16px; margin-bottom: 20px;">
      Dieses Passwort ben√∂tigen deine Mitarbeiter f√ºr den Scanner-Zugang. Es wird t√§glich automatisch gewechselt.
    </p>

    <div class="password-display">
      <div style="font-size: 14px; color: #6b7280; margin-bottom: 8px; font-weight: 600;">
        AKTUELLES PASSWORT F√úR HEUTE:
      </div>
      <div class="current-password" id="currentPassword">
        L√§dt...
      </div>
      <button class="copy-btn" onclick="copyPassword()">
        üìã Passwort kopieren
      </button>
      <div style="font-size: 13px; color: #059669; margin-top: 16px; font-weight: 600;" id="copyStatus"></div>
    </div>

    <div class="password-info">
      <div class="info-item">
        <div class="info-value" id="passwordDate">--</div>
        <div class="info-label">G√ºltig f√ºr</div>
      </div>
      <div class="info-item">
        <div class="info-value" id="passwordExpiry">--:--</div>
        <div class="info-label">L√§uft ab in</div>
      </div>
      <div class="info-item">
        <div class="info-value" id="passwordLength">--</div>
        <div class="info-label">Zeichen</div>
      </div>
    </div>

    <button class="generate-btn" onclick="generateNewPassword()">
      üîÑ Neues Passwort jetzt generieren
    </button>

    <div class="security-badge">
      üîí <strong>Sicherheits-Tipp:</strong> Teile das Passwort nur pers√∂nlich mit deinen Mitarbeitern. 
      Schicke es nicht per WhatsApp oder E-Mail! üì±‚ùå
    </div>
  </div>

  <!-- PASSWORT HISTORIE -->
  <div class="card">
    <h2>üìú Passwort-Historie</h2>
    <p class="subtitle">Letzte 10 Passw√∂rter (nur zur √úbersicht)</p>
    <button class="secondary" onclick="loadPasswordHistory()" style="width: auto; margin-bottom: 16px;">
      üîÑ Aktualisieren
    </button>
    <div class="history-list" id="passwordHistory">
      <div style="text-align: center; padding: 20px; color: #6b7280;">Lade Historie...</div>
    </div>
  </div>

  <!-- QUICK STATS -->
  <div class="card">
    <h2>üìä System-√úbersicht</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
      <div style="background: #f9fafb; padding: 20px; border-radius: 12px; text-align: center;">
        <div style="font-size: 36px; font-weight: 700; color: #E31E24;" id="totalCustomers">0</div>
        <div style="font-size: 14px; color: #6b7280; margin-top: 8px;">Kunden gesamt</div>
      </div>
      <div style="background: #f9fafb; padding: 20px; border-radius: 12px; text-align: center;">
        <div style="font-size: 36px; font-weight: 700; color: #F9A825;" id="totalPoints">0</div>
        <div style="font-size: 14px; color: #6b7280; margin-top: 8px;">Punkte vergeben</div>
      </div>
      <div style="background: #f9fafb; padding: 20px; border-radius: 12px; text-align: center;">
        <div style="font-size: 36px; font-weight: 700; color: #10b981;" id="todayTransactions">0</div>
        <div style="font-size: 14px; color: #6b7280; margin-top: 8px;">Transaktionen heute</div>
      </div>
      <div style="background: #f9fafb; padding: 20px; border-radius: 12px; text-align: center;">
        <div style="font-size: 36px; font-weight: 700; color: #3b82f6;" id="activeLogins">--</div>
        <div style="font-size: 14px; color: #6b7280; margin-top: 8px;">Letzte Aktivit√§t</div>
      </div>
    </div>
  </div>

  <!-- SICHERHEITS-EINSTELLUNGEN -->
  <div class="card" style="border: 2px solid #dc2626;">
    <h2>‚öôÔ∏è Sicherheits-Einstellungen</h2>
    <p class="subtitle">Passwort-System konfigurieren</p>
    
    <div style="background: #fee2e2; border: 2px solid #dc2626; border-radius: 10px; padding: 16px; margin-bottom: 16px;">
      <h3 style="color: #991b1b; margin-bottom: 12px;">üîí Master-Passwort √§ndern</h3>
      <p style="color: #991b1b; font-size: 13px; margin-bottom: 12px;">
        √Ñndere hier dein Admin-Passwort f√ºr diese Seite (nicht das Scanner-Passwort!)
      </p>
      <input type="password" id="currentMasterPassword" placeholder="Aktuelles Master-Passwort">
      <input type="password" id="newMasterPassword" placeholder="Neues Master-Passwort">
      <input type="password" id="confirmMasterPassword" placeholder="Neues Passwort best√§tigen">
      <button class="danger" style="width: 100%;" onclick="changeMasterPassword()">
        üîê Master-Passwort √§ndern
      </button>
      <div id="result-master-password"></div>
    </div>

    <div style="background: #dbeafe; border: 2px solid #3b82f6; border-radius: 10px; padding: 16px;">
      <h3 style="color: #1e40af; margin-bottom: 12px;">ü§ñ Automatische Passwort-Generierung</h3>
      <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
        <div style="flex: 1;">
          <p style="color: #1e40af; font-size: 14px; font-weight: 600;">
            Status: <span id="autoGenStatus" style="color: #10b981;">‚úÖ Aktiv</span>
          </p>
          <p style="color: #1e40af; font-size: 13px; margin-top: 4px;">
            Generiert t√§glich um 00:00 Uhr ein neues Passwort
          </p>
        </div>
      </div>
      <div style="font-size: 12px; color: #1e40af; background: rgba(59, 130, 246, 0.1); padding: 10px; border-radius: 6px; margin-top: 12px;">
        ‚ÑπÔ∏è Die automatische Generierung l√§uft √ºber einen Supabase pg_cron Job. 
        Pr√ºfe in deinem Supabase Dashboard unter "Database" ‚Üí "Extensions", ob pg_cron aktiviert ist.
      </div>
    </div>
  </div>

  <div id="result-global"></div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
// üîí SUPABASE CONFIG
const supabaseUrl = 'https://pskuvrahvxlzrnxmuqnc.supabase.co'
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBza3V2cmFodnhsenJueG11cW5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1NTA2MTYsImV4cCI6MjA3ODEyNjYxNn0.Ji5dTEFsGbgW9t79yhJg-nOHkzc0Z0oHtVe6c-iBvds'
const supabase = window.supabase.createClient(supabaseUrl, supabaseKey)

// Admin Passwort (in production sollte dies sicherer gespeichert werden)
const ADMIN_PASSWORD = 'Ahmet00461963!'
const SESSION_KEY = 'admin_session'
const SESSION_DURATION = 24 * 60 * 60 * 1000 // 24 Stunden

let isLoggedIn = false

// Check session on load
function checkSession() {
  const session = localStorage.getItem(SESSION_KEY)
  if (session) {
    const sessionData = JSON.parse(session)
    const now = new Date().getTime()
    
    if ((now - sessionData.timestamp) < SESSION_DURATION) {
      isLoggedIn = true
      showApp()
      return
    } else {
      localStorage.removeItem(SESSION_KEY)
    }
  }
}

function handleLogin() {
  const password = document.getElementById('adminPassword').value.trim()
  const errorDiv = document.getElementById('loginError')
  
  if (password === ADMIN_PASSWORD) {
    isLoggedIn = true
    const sessionData = { timestamp: new Date().getTime() }
    localStorage.setItem(SESSION_KEY, JSON.stringify(sessionData))
    errorDiv.style.display = 'none'
    showApp()
  } else {
    errorDiv.textContent = '‚ùå Falsches Passwort!'
    errorDiv.style.display = 'block'
    document.getElementById('adminPassword').value = ''
  }
}

function showApp() {
  document.getElementById('loginScreen').style.display = 'none'
  document.getElementById('app').style.display = 'block'
  loadCurrentPassword()
  loadPasswordHistory()
  loadStats()
}

function handleLogout() {
  localStorage.removeItem(SESSION_KEY)
  isLoggedIn = false
  document.getElementById('app').style.display = 'none'
  document.getElementById('loginScreen').style.display = 'block'
  document.getElementById('adminPassword').value = ''
}

function togglePasswordVisibility() {
  const input = document.getElementById('adminPassword')
  const toggle = document.querySelector('.toggle-password')
  if (input.type === 'password') {
    input.type = 'text'
    toggle.textContent = 'üôà'
  } else {
    input.type = 'password'
    toggle.textContent = 'üëÅÔ∏è'
  }
}

// Enter key to login
document.getElementById('adminPassword')?.addEventListener('keypress', function(e) {
  if (e.key === 'Enter') handleLogin()
})

// üîê PASSWORT MANAGEMENT FUNKTIONEN

async function loadCurrentPassword() {
  try {
    const today = new Date().toISOString().split('T')[0]
    const { data, error } = await supabase
      .from('daily_passwords')
      .select('*')
      .eq('date', today)
      .single()
    
    if (error) {
      // Wenn kein Passwort f√ºr heute existiert, erstelle eins
      if (error.code === 'PGRST116') {
        await generateNewPassword()
        return
      }
      throw error
    }
    
    if (data) {
      document.getElementById('currentPassword').textContent = data.password
      document.getElementById('passwordDate').textContent = new Date(data.date).toLocaleDateString('de-DE')
      document.getElementById('passwordLength').textContent = data.password.length + ' Zeichen'
      updateExpiry()
    }
  } catch (e) {
    console.error('Load password error:', e)
    document.getElementById('currentPassword').textContent = 'Fehler beim Laden'
  }
}

function updateExpiry() {
  const now = new Date()
  const midnight = new Date()
  midnight.setHours(24, 0, 0, 0)
  
  const diff = midnight - now
  const hours = Math.floor(diff / (1000 * 60 * 60))
  const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60))
  
  document.getElementById('passwordExpiry').textContent = `${hours}h ${minutes}m`
  
  // Update every minute
  setTimeout(updateExpiry, 60000)
}

async function copyPassword() {
  const password = document.getElementById('currentPassword').textContent
  
  try {
    await navigator.clipboard.writeText(password)
    const status = document.getElementById('copyStatus')
    status.textContent = '‚úÖ Passwort kopiert!'
    setTimeout(() => status.textContent = '', 3000)
  } catch (e) {
    alert('Kopieren fehlgeschlagen. Bitte manuell markieren und kopieren.')
  }
}

async function generateNewPassword() {
  if (!confirm('Neues Passwort generieren? Das alte wird ung√ºltig!')) return
  
  try {
    // Generate random password (8-12 chars, letters + numbers)
    const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'
    const length = 8 + Math.floor(Math.random() * 5)
    let password = ''
    
    for (let i = 0; i < length; i++) {
      password += chars.charAt(Math.floor(Math.random() * chars.length))
    }
    
    const today = new Date().toISOString().split('T')[0]
    
    // Insert or update
    const { error } = await supabase
      .from('daily_passwords')
      .upsert({
        date: today,
        password: password,
        created_by: 'admin',
        is_active: true
      }, {
        onConflict: 'date'
      })
    
    if (error) throw error
    
    alert('‚úÖ Neues Passwort generiert!')
    loadCurrentPassword()
    loadPasswordHistory()
  } catch (e) {
    console.error('Generate password error:', e)
    alert('‚ùå Fehler: ' + e.message)
  }
}

async function loadPasswordHistory() {
  try {
    const { data, error } = await supabase
      .from('daily_passwords')
      .select('*')
      .order('date', { ascending: false })
      .limit(10)
    
    if (error) throw error
    
    const list = document.getElementById('passwordHistory')
    
    if (!data || data.length === 0) {
      list.innerHTML = '<div style="text-align: center; padding: 20px; color: #6b7280;">Keine Historie verf√ºgbar</div>'
      return
    }
    
    list.innerHTML = data.map(item => `
      <div class="history-item">
        <div>
          <div class="history-date">${new Date(item.date).toLocaleDateString('de-DE', { weekday: 'short', day: '2-digit', month: '2-digit', year: 'numeric' })}</div>
          <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">
            Erstellt: ${new Date(item.created_at).toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' })} Uhr
          </div>
        </div>
        <div class="history-password">${item.password}</div>
      </div>
    `).join('')
  } catch (e) {
    console.error('Load history error:', e)
    document.getElementById('passwordHistory').innerHTML = '<div style="text-align: center; padding: 20px; color: #dc2626;">Fehler beim Laden</div>'
  }
}

async function loadStats() {
  try {
    // Kunden gesamt
    const { count: customerCount } = await supabase
      .from('customers')
      .select('*', { count: 'exact', head: true })
    
    document.getElementById('totalCustomers').textContent = customerCount || 0
    
    // Punkte gesamt
    const { data: customers } = await supabase
      .from('customers')
      .select('points')
    
    const totalPoints = customers?.reduce((sum, c) => sum + (c.points || 0), 0) || 0
    document.getElementById('totalPoints').textContent = totalPoints.toLocaleString('de-DE')
    
    // Transaktionen heute
    const today = new Date().toISOString().split('T')[0]
    const { count: txCount } = await supabase
      .from('transactions')
      .select('*', { count: 'exact', head: true })
      .gte('created_at', today + 'T00:00:00')
    
    document.getElementById('todayTransactions').textContent = txCount || 0
    
    // Letzte Aktivit√§t
    const { data: lastTx } = await supabase
      .from('transactions')
      .select('created_at')
      .order('created_at', { ascending: false })
      .limit(1)
      .single()
    
    if (lastTx) {
      const lastTime = new Date(lastTx.created_at)
      const now = new Date()
      const diff = Math.floor((now - lastTime) / 60000) // Minuten
      
      if (diff < 60) {
        document.getElementById('activeLogins').textContent = `vor ${diff}m`
      } else {
        const hours = Math.floor(diff / 60)
        document.getElementById('activeLogins').textContent = `vor ${hours}h`
      }
    } else {
      document.getElementById('activeLogins').textContent = '--'
    }
  } catch (e) {
    console.error('Load stats error:', e)
  }
}

function changeMasterPassword() {
  const current = document.getElementById('currentMasterPassword').value
  const newPass = document.getElementById('newMasterPassword').value
  const confirm = document.getElementById('confirmMasterPassword').value
  const resultDiv = document.getElementById('result-master-password')
  
  if (!current || !newPass || !confirm) {
    showResult('result-master-password', '‚ùå Alle Felder ausf√ºllen!', 'error')
    return
  }
  
  if (current !== ADMIN_PASSWORD) {
    showResult('result-master-password', '‚ùå Aktuelles Passwort falsch!', 'error')
    return
  }
  
  if (newPass !== confirm) {
    showResult('result-master-password', '‚ùå Neue Passw√∂rter stimmen nicht √ºberein!', 'error')
    return
  }
  
  if (newPass.length < 8) {
    showResult('result-master-password', '‚ùå Passwort muss mindestens 8 Zeichen haben!', 'error')
    return
  }
  
  // In production: Hier w√ºrde das Passwort in einer Datenbank gespeichert
  alert('‚ö†Ô∏è WICHTIG: In dieser Demo wird das Passwort nur im Code ge√§ndert.\nIn der Produktions-Version muss das Passwort sicher in der Datenbank gespeichert werden!')
  showResult('result-master-password', '‚úÖ Passwort w√ºrde in Produktion ge√§ndert werden!', 'success')
  
  // Felder leeren
  document.getElementById('currentMasterPassword').value = ''
  document.getElementById('newMasterPassword').value = ''
  document.getElementById('confirmMasterPassword').value = ''
}

function showResult(id, message, type) {
  const el = document.getElementById(id)
  el.textContent = message
  el.className = `result ${type}`
  el.style.display = 'block'
  setTimeout(() => el.style.display = 'none', 5000)
}

// Check session on load
checkSession()

// Auto-refresh stats every 30 seconds
setInterval(() => {
  if (isLoggedIn) {
    loadStats()
  }
}, 30000)

console.log('‚úÖ Admin Panel mit Passwort-Management geladen!')
</script>

</body>
</html>
